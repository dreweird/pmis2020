<div class="container">
    <div class="row">
        <div class="col-12">
            <h2>Department of Agriculture</h2>
            <h3>Caraga Region   </h3>
            <h3>CY 2020 Interventions based on GAA</h3>
        </div>
      </div>
      <div class="row" [ngClass]="routeAnimationsElements">
          <div class="col-md-10">
            <form [formGroup]="inputForm" #formDirective="ngForm">
                <table class="example-full-width" cellspacing="0">
                  <tr>
                    <td>
                      <mat-form-field>
                        <mat-label>Select Program</mat-label>
                        <mat-select formControlName="prog">
                          <mat-option *ngFor="let p of prog" [value]="p.pid">{{p.value}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </td>
                    <td>
                      <mat-form-field>
                        <mat-label>Select Province</mat-label>
                        
                        <mat-select formControlName="prov">
                          <mat-option *ngFor="let p of prov" [value]="p.province">{{p.province}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </td>
                    <td>
        
                      <mat-form-field>
                        <mat-label>Select District</mat-label>
                        <mat-select formControlName="district">
                          <mat-option *ngFor="let d of district" [value]="d.value">{{d.value}}</mat-option>
                        </mat-select>
                      </mat-form-field>
                    </td>
                    <td>
                      <button [disabled]="!inputForm.valid" mat-raised-button color="primary"
                        (click)="onGenerate(formDirective)">Generate Report</button>
                    </td>
                  </tr>
                </table>
              </form>
            </div>
          <div  class="col-md-2">
              <button style="margin:5px;" mat-raised-button class="information" (click)="exportcsv()">
                  EXPORT to EXCEL
                </button> 
                <br>
          </div>
    
        </div>
        <div class="row" *ngIf="provselect">
            <div class="col-12">
            <h3>{{provselect}}, District {{distselect}}</h3>
            </div>
        </div>
        <br>
        <div [ngClass]="routeAnimationsElements">
            <ag-grid-angular 
              style="width: 100%; height: 400px;" 
              class="ag-theme-balham"
              [rowData]="rowData" 
              [columnDefs]="columnDefs"
              [components]="components"
              [excelStyles]="excelStyles"
              [groupDefaultExpanded]=-1
              [defaultColDef]="defaultColDef"
              [autoGroupColumnDef]="autoGroupColumnDef"
              (gridReady)="onGridReady($event)"
           
    
              >
          </ag-grid-angular>
          </div> <br>
  </div>
  
  
  